<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Top disclaimer will be added to body -->
    <!-- Bottom disclaimer will be added to body -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DICOM RT Plan Delivery Simulator (Illustrative Purpose Only)</title>
    <link rel="icon" href="data:,">

    <script>
        // Registration check - must be first
        (function() {
            const isRegistered = localStorage.getItem('simulator_registered');
            if (!isRegistered) {
                // Redirect to registration page
                window.location.href = 'gate/register.html';
                return;
            }
        })();

        // Function to show a custom message modal
        function showMessageModal(title, message) {
            // Check if modal elements exist, create if not
            let modal = document.getElementById('customMessageModal');
            if (!modal) {
                modal = document.createElement('div');
                modal.id = 'customMessageModal';
                modal.style.position = 'fixed';
                modal.style.left = '0';
                modal.style.top = '0';
                modal.style.width = '100%';
                modal.style.height = '100%';
                modal.style.backgroundColor = 'rgba(0,0,0,0.5)';
                modal.style.display = 'none'; // Initially hidden
                modal.style.justifyContent = 'center';
                modal.style.alignItems = 'center';
                modal.style.zIndex = '10000'; // Ensure it's on top

                const modalContent = document.createElement('div');
                modalContent.style.backgroundColor = '#fff';
                modalContent.style.padding = '20px';
                modalContent.style.borderRadius = '8px';
                modalContent.style.textAlign = 'center';
                modalContent.style.minWidth = '300px';
                modalContent.style.maxWidth = '80%';
                modalContent.style.boxShadow = '0 4px 15px rgba(0,0,0,0.2)';

                const modalTitle = document.createElement('h3');
                modalTitle.id = 'customMessageModalTitle';
                modalTitle.style.marginTop = '0';

                const modalText = document.createElement('p');
                modalText.id = 'customMessageModalText';
                modalText.style.whiteSpace = 'pre-wrap'; // Preserve line breaks

                const closeButton = document.createElement('button');
                closeButton.textContent = 'Close';
                closeButton.style.padding = '10px 20px';
                closeButton.style.marginTop = '15px';
                closeButton.style.backgroundColor = '#3498db';
                closeButton.style.color = 'white';
                closeButton.style.border = 'none';
                closeButton.style.borderRadius = '5px';
                closeButton.style.cursor = 'pointer';
                closeButton.onclick = function () {
                    modal.style.display = 'none';
                };

                modalContent.appendChild(modalTitle);
                modalContent.appendChild(modalText);
                modalContent.appendChild(closeButton);
                modal.appendChild(modalContent);
                document.body.appendChild(modal);
            }

            // Set title and message
            document.getElementById('customMessageModalTitle').textContent = title;
            document.getElementById('customMessageModalText').textContent = message;
            modal.style.display = 'flex'; // Show the modal
        }


        // Script loading with fallback
        function loadScriptWithFallback(localPath, cdnPath, integrityHash = null, crossorigin = null) {
            return new Promise((resolve, reject) => {
                const script = document.createElement('script');
                script.src = localPath;
                script.onload = () => {
                    console.log(`DEBUG: ${localPath} loaded successfully locally.`);
                    resolve();
                };
                script.onerror = () => {
                    console.warn(`DEBUG: Failed to load ${localPath} locally. Attempting CDN fallback: ${cdnPath}`);
                    const fallbackScript = document.createElement('script');
                    fallbackScript.src = cdnPath;
                    if (integrityHash) fallbackScript.integrity = integrityHash;
                    if (crossorigin) fallbackScript.crossOrigin = crossorigin;
                    fallbackScript.onload = () => {
                        console.log(`DEBUG: ${cdnPath} loaded successfully from CDN.`);
                        resolve();
                    };
                    fallbackScript.onerror = () => {
                        console.error(`DEBUG: Failed to load script from both local and CDN: ${localPath} / ${cdnPath}`);
                        reject(new Error(`Failed to load ${cdnPath} from CDN after local failure.`));
                    };
                    document.head.appendChild(fallbackScript);
                };
                document.head.appendChild(script);
            });
        }

        async function loadCriticalScripts() {
            try {
                await loadScriptWithFallback('dcmjs.js', 'https://cdn.jsdelivr.net/npm/dcmjs/build/dcmjs.js');
                await loadScriptWithFallback('Tone.js', 'https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.js');
                console.log('DEBUG: All critical scripts (dcmjs, Tone.js) loaded.');
            } catch (error) {
                console.error("DEBUG: Critical script loading error:", error);
                // Use custom modal instead of alert
                showMessageModal("Critical Library Load Error", "A critical library (dcmjs or Tone.js) failed to load. The application might not work correctly. Please check the browser console for more details.");
            }
        }
        loadCriticalScripts(); // Call immediately in head
    </script>

    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f4f7f6;
            color: #333;
            /* Add padding for fixed header */
            padding-top: 45px;
        }

        /* Disclaimer styles */
        .disclaimer-header {
            background-color: #3498db;
            color: white;
            padding: 10px;
            text-align: center;
            font-weight: bold;
            /* Make header sticky */
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }

        .disclaimer-footer {
            background-color: #f8f9fa;
            padding: 10px;
            text-align: center;
            font-size: 0.9em;
            border-top: 1px solid #dee2e6;
            margin-top: 15px;
        }

        .disclaimer-footer a {
            color: #3498db;
            text-decoration: none;
        }

        .disclaimer-footer a:hover {
            text-decoration: underline;
        }

        h1,
        h2,
        h3 {
            color: #2c3e50;
            margin-top: 10px;
            margin-bottom: 10px;
        }

        .container {
            display: flex;
            flex-direction: column;
            gap: 15px;
            max-width: 1400px;
            margin: 0 auto;
            background-color: #fff;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .author-info-header,
        .plan-info-header {
            background-color: #e9ecef;
            padding: 10px 15px;
            border-radius: 5px;
            margin-bottom: 10px;
            font-size: 0.85em;
            border: 1px solid #ced4da;
            color: #495057;
        }

        .author-info-header p,
        .plan-info-header p {
            margin: 5px 0;
            line-height: 1.4;
        }

        .author-info-header strong,
        .plan-info-header strong {
            color: #343a40;
        }

        .plan-info-header h3 {
            margin-top: 0;
            color: #2c3e50;
            font-size: 1.1em;
        }

        .plan-info-header ul {
            list-style-type: none;
            padding-left: 0;
            margin-top: 5px;
        }

        .plan-info-header li {
            padding: 3px 0;
            border-bottom: 1px dotted #ccc;
            font-size: 0.95em;
        }

        .plan-info-header li:last-child {
            border-bottom: none;
        }

        .visualization-section {
            width: 100%;
            border: 1px solid #e0e0e0;
            border-radius: 5px;
            padding: 10px;
            box-sizing: border-box;
            margin-bottom: 15px;
            position: relative;
        }

        canvas {
            border: 1px solid #ccc;
            background-color: #fafafa;
            display: block;
            margin: 5px auto;
            box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.1);
            cursor: grab;
        }

        canvas:active {
            cursor: grabbing;
        }


        .xy-plot-canvas {
            width: 100%;
            max-width: 600px;
            height: 350px;
            margin: 10px auto;
        }


        .controls,
        .beam-selector-controls,
        .mode-controls,
        .speed-limit-controls {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 8px;
            margin-top: 10px;
            flex-wrap: wrap;
        }

        .speed-limit-controls>div {
            display: flex;
            align-items: center;
            gap: 5px;
            padding: 3px;
            border: 1px solid #eee;
            border-radius: 4px;
            background-color: #f9f9f9;
        }


        .controls button,
        .beam-selector-controls button,
        .mode-controls button,
        .speed-limit-controls button,
        .xy-plot-container button {
            padding: 8px 12px;
            font-size: 14px;
            cursor: pointer;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 5px;
            transition: background-color 0.3s ease;
            margin-top: 5px;
        }

        .controls button:hover,
        .beam-selector-controls button:hover,
        .mode-controls button:hover,
        .speed-limit-controls button:hover,
        .xy-plot-container button:hover {
            background-color: #2980b9;
        }

        #exportDataBtn {
            background-color: #16a085;
            margin-right: 10px;
        }

        #exportDataBtn:hover {
            background-color: #117a65;
        }

        .mode-controls button.active-mode {
            background-color: #27ae60;
        }

        .mode-controls label {
            font-size: 0.85em;
            vertical-align: middle;
        }

        .mode-controls input[type="checkbox"] {
            vertical-align: middle;
            width: 15px;
            height: 15px;
        }

        .speed-limit-controls label {
            font-size: 0.8em;
            margin-right: 3px;
            white-space: nowrap;
        }

        .speed-limit-controls input[type="number"] {
            width: 60px;
            padding: 6px;
            border-radius: 4px;
            border: 1px solid #ccc;
            font-size: 0.85em;
        }

        .beam-selector-controls select {
            padding: 8px;
            font-size: 14px;
            border-radius: 5px;
            border: 1px solid #ccc;
        }

        .param-display {
            margin-top: 10px;
            font-size: 1em;
            line-height: 1.5;
        }

        .param-item {
            display: flex;
            justify-content: space-between;
            padding: 4px 0;
            border-bottom: 1px dashed #eee;
        }

        .param-item:last-child {
            border-bottom: none;
        }

        .notes {
            background-color: #eaf6ff;
            border-left: 5px solid #3498db;
            padding: 10px;
            margin-top: 10px;
            border-radius: 4px;
            width: 100%;
            box-sizing: border-box;
        }

        .notes h3 {
            margin-top: 0;
            color: #2980b9;
        }

        .file-input-section {
            width: 100%;
            padding: 15px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            background-color: #fdfdfd;
            margin-bottom: 15px;
            box-sizing: border-box;
            position: relative;
        }

        .file-input-section .top-right-buttons {
            position: absolute;
            top: 15px;
            right: 15px;
            display: flex;
            gap: 10px;
        }


        .file-input-section input[type="file"] {
            margin-right: 8px;
            margin-bottom: 4px;
        }

        .radial-plot-grid {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-around;
            gap: 8px;
        }

        .radial-plot-container {
            width: calc(33.333% - 10px);
            min-width: 230px;
            text-align: center;
            box-sizing: border-box;
            padding: 5px;
            margin-bottom: 10px;
        }


        .radial-plot-container h3 {
            margin-top: 3px;
            margin-bottom: 3px;
            font-size: 0.9em;
            color: #555;
        }

        .xy-time-plots-section h2 {
            text-align: center;
            margin-bottom: 15px;
        }

        .xy-time-plot-grid {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-around;
            gap: 15px;
        }

        .xy-time-plot-container {
            width: 100%;
            max-width: 620px;
            box-sizing: border-box;
            padding: 5px;
            border: 1px solid #eee;
            border-radius: 5px;
            background-color: #fdfdfd;
            text-align: center;
        }


        .data-input-group {
            margin-bottom: 10px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }

        .data-input-group:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }

        .data-input-group h3 {
            margin-bottom: 8px;
        }


        .slider-controls {
            width: 100%;
            margin-top: 15px;
            padding: 8px;
            box-sizing: border-box;
            text-align: center;
        }

        .slider-controls label {
            margin-right: 8px;
            font-size: 0.85em;
        }

        .slider-controls input[type="range"] {
            width: 65%;
            max-width: 450px;
            cursor: pointer;
        }

        #dicomDropZone {
            border: 2px dashed #ccc;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            color: #888;
            font-size: 1em;
            margin-top: 8px;
            background-color: #f9f9f9;
            transition: background-color 0.2s ease, border-color 0.2s ease;
        }

        #dicomDropZone.dragover {
            background-color: #e9e9e9;
            border-color: #aaa;
        }

        @media (max-width: 1000px) {
            .radial-plot-container {
                width: calc(50% - 10px);
            }
        }

        @media (max-width: 520px) {
            .radial-plot-container {
                width: 100%;
                min-width: 220px;
            }
        }
    </style>
</head>

<body>
    <!-- Top disclaimer -->
    <div class="disclaimer-header">
        **NOT VALIDATED FOR CLINICAL USE**
    </div>

    <div class="container">


        <h1>DICOM RT Plan Delivery Simulator</h1>
        <div class="notes">
            <style>
                details.info-dropdown {
                    margin-bottom: 1em;
                }
                details.info-dropdown summary {
                    font-size: 1.17em;
                    font-weight: bold;
                    cursor: pointer;
                }
            </style>
            <details class="info-dropdown" open>
                <summary>Important Information</summary>
                <p style="color:red;">
                    For Educational and Research Purpose Only. Not Validated For Clinical Use. Estimated Time Not Guaranteed to Match
                    Actual Delivery Time.
                </p>
            <p>
                <strong>Step 1: Load your plan file.</strong>
            <ul>
                <li>Drag and drop your DICOM RT Plan (<code>.dcm</code>) or exported JSON (<code>.json</code>) file onto
                    the designated area below.</li>
                <li>Alternatively, use the "Choose File" button.</li>
            </ul>
            </p>
            <p>
                <strong>Step 2: Configure Simulation (Optional).</strong>
                Adjust the machine speed and acceleration limits below if you want to customize the
                "Simulate Delivery" mode. Default speeds may adjust based on the loaded plan's machine type.
            </p>
            <p>
                <strong>Step 3: Select a Beam (if multiple exist).</strong>
                Use the dropdown menu that appears above the BEV to select the beam you wish to visualize.
                Overall plan info shows overall MCSv (now includes collimator factor) for each beam (calculated
                segmentally).
            </p>
            <p>
                <strong>Step 4: Choose Playback Mode & Interact.</strong>
            <ul>
                <li>Use the "Simulate Delivery" / "Use Fixed Speed Animation" button to toggle playback modes for a
                    single beam.</li>
                <li>Use the "Simulate Full Plan" button to simulate all beams delivered consecutively, including an
                    animated transition between beams where the MLCs also move.</li>
                <li>Enable "Beep per MU" for audible feedback during simulation (max 20 beeps/sec).</li>
                <li>Move your mouse cursor over the Radial Plots or use the slider to scrub through control
                    points. The "MIsport" (Li & Xing, Med. Phys. 40 (5), May 2013) plot and "Local MIt" (Park et al,
                    Phys. Med. Biol. 59 (2014) 7315-7340) plot (now include collimator factors) use a rolling
                    window. Both visually exclude the first and last CPs of the beam.
                </li>
                <li>XY plots for Speed/Acceleration vs. Time will appear below when "Simulate Delivery" mode is active
                    and a plan is loaded. Use mouse wheel to zoom (Shift+Wheel for X-axis, Ctrl+Wheel for Y-axis) and
                    click-drag to pan these plots.</li>
            </ul>
            </p>
            </details>
        </div>

        <div class="file-input-section">
            <h2>Load RT Plan Data & Configure Simulation Parameters</h2>
            <div class="top-right-buttons">
                <button id="exportDataBtn">Export Parsed Data</button>
                <button id="clearAllBtn" style="background-color: #e74c3c;">Clear All Data</button>
            </div>

            <div class="data-input-group">
                <h3>Load from Plan File</h3>
                <div id="dicomDropZone">Drag & Drop your DICOM (.dcm) or exported JSON (.json) file here
                    <br> or <br>
                    <input type="file" id="dicomFileInput" accept=".dcm,application/dicom,.json,application/json">
                </div>
            </div>

            <div class="data-input-group speed-limit-controls">
                <h3>Machine Speed & Acceleration Limits (for Simulation)</h3>
                <div>
                    <label for="maxGantrySpeedInput">Max Gantry Speed (°/s):</label>
                    <input type="number" id="maxGantrySpeedInput" value="6" step="0.1">
                </div>
                <div>
                    <label for="maxGantryAccelDecelInput">Max Gantry Accel/Decel (°/s²):</label>
                    <input type="number" id="maxGantryAccelDecelInput" value="12" step="0.1">
                </div>
                <div>
                    <label for="maxMlcSpeedInput">Max MLC Speed (cm/s):</label>
                    <input type="number" id="maxMlcSpeedInput" value="2.25" step="0.1">
                </div>
                <div>
                    <label for="maxMlcAccelDecelInput">Max MLC Accel/Decel (cm/s²):</label>
                    <input type="number" id="maxMlcAccelDecelInput" value="10" step="0.1">
                </div>
                <div>
                    <label for="maxCollimatorSpeedInput">Max Coll Speed (°/s):</label>
                    <input type="number" id="maxCollimatorSpeedInput" value="9" step="0.1">
                </div>
                <div> <label for="maxCollimatorAccelDecelInput">Max Coll Accel/Decel (°/s²):</label>
                    <input type="number" id="maxCollimatorAccelDecelInput" value="10" step="0.1">
                </div>
                <div> <label for="maxJawSpeedInput">Max Jaw Speed (cm/s):</label>
                    <input type="number" id="maxJawSpeedInput" value="2.0" step="0.1">
                </div>
                <div> <label for="maxJawAccelDecelInput">Max Jaw Accel/Decel (cm/s²):</label>
                    <input type="number" id="maxJawAccelDecelInput" value="8.0" step="0.1">
                </div>
                <button id="applySpeedLimitsBtn">Apply & Recalculate Simulation</button>
            </div>
        </div>

        <div class="plan-info-header" id="overallPlanInfoContainer" style="display:none;">
            <h3>Overall Plan Information</h3>
            <p><strong>Patient Name:</strong> <span id="planPatientName">N/A</span></p>
            <p><strong>Patient ID:</strong> <span id="planPatientID">N/A</span></p>
            <p><strong>Plan Label:</strong> <span id="planLabel">N/A</span></p>
            <p><strong>Total Beams in Plan:</strong> <span id="planTotalBeams">N/A</span></p>
            <p><strong>Total Plan MU:</strong> <span id="planTotalMU">N/A</span></p>
            <p><strong>Primary Dose Rate (First Beam, CP0):</strong> <span id="planDoseRate">N/A</span> MU/min</p>
            <p><strong>Est. Total Plan Time (All Beams):</strong> <span id="totalPlanSimTime">N/A</span> s</p>
            <div id="individualBeamInfoContainer">
            </div>
        </div>


        <div class="mode-controls">
            <button id="toggleSimulationBtn">Simulate Delivery</button>
            <button id="toggleAllBeamsSimBtn">Simulate Full Plan</button>
            <span style="margin-left: 20px;">
                <input type="checkbox" id="beepPerMUToggle" style="vertical-align: middle;">
                <label for="beepPerMUToggle" style="vertical-align: middle;">Beep per MU (Sim Mode)</label>
            </span>
        </div>

        <div class="beam-selector-controls" id="beamSelectorContainer" style="display:none;">
            <label for="beamSelector">Select Beam:</label>
            <select id="beamSelector"></select>
        </div>

        <div class="visualization-section">
            <h2>Beam's Eye View (BEV)</h2>
            <canvas id="bevCanvas" width="400" height="400"></canvas>
            <div class="controls">
                <button id="playPauseBtn">Play</button>
                <button id="resetBtn">Reset</button>
            </div>
            <div class="param-display">
                <h3>Current Control Point: <span id="currentCPIndex">0</span> / <span id="totalCPs">0</span></h3>
                <div class="param-item"><strong>Gantry Angle:</strong> <span id="gantryAngle">N/A</span>°</div>
                <div class="param-item"><strong>Collimator Angle:</strong> <span id="collimatorAngle">N/A</span>°</div>
                <div class="param-item" id="simTimeDisplay" style="display:none;"><strong>Simulated Time
                        Elapsed:</strong> <span id="simTimeElapsed">0.00</span> s</div>
                <div class="param-item" id="totalSimTimeDisplay" style="display:none;">
                    <strong>Est. Total Beam Time:</strong>
                    <span id="totalSimTime">0.00</span> s
                </div>
                <p style="color: red; font-size: 0.8em; margin-left: 10px;">(For Illustrative Purpose Only, Not
                    Representative of Actual Delivery)</p>
            </div>
        </div>

        <div class="visualization-section">
            <h2>Parameter Distribution (Static Radial Plots)</h2>
            <p style="text-align:center; font-size:0.9em; color:#555;">(Move mouse over plots to scrub through control
                points)</p>
            <div class="radial-plot-grid">
                <div class="radial-plot-container">
                    <h3>Gantry Speed</h3>
                    <canvas id="gantrySpeedCanvas" width="220" height="220"></canvas>
                </div>
                <div class="radial-plot-container">
                    <h3>Max MLC Speed</h3>
                    <canvas id="mlcSpeedCanvas" width="220" height="220"></canvas>
                </div>
                <div class="radial-plot-container">
                    <h3>Collimator Speed</h3>
                    <canvas id="collimatorSpeedCanvas" width="220" height="220"></canvas>
                </div>
                <div class="radial-plot-container">
                    <h3>Dose Rate</h3>
                    <canvas id="doseRateCanvas" width="220" height="220"></canvas>
                </div>
                <div class="radial-plot-container">
                    <h3>MIsport</h3>
                    <canvas id="miCanvas" width="220" height="220"></canvas>
                </div>
                <div class="radial-plot-container">
                    <h3>Local MIt</h3> <canvas id="localMItCanvas" width="220" height="220"></canvas>
                </div>
            </div>
            <div class="slider-controls">
                <label for="cpSlider">Control Point Selector:</label>
                <input type="range" id="cpSlider" min="0" max="0" value="0">
            </div>
            <div class="param-display">
                <h3>Calculated Values (Current CP):</h3>
                <div class="param-item"><strong>Gantry Speed:</strong> <span id="gantrySpeedVal">N/A</span></div>
                <div class="param-item"><strong>Fastest MLC Speed:</strong> <span id="mlcSpeedVal">N/A</span></div>
                <div class="param-item"><strong>Collimator Speed:</strong> <span id="collimatorSpeedVal">N/A</span>
                </div>
                <div class="param-item"><strong>Fastest Jaw X Speed:</strong> <span id="jawXSpeedVal">N/A</span></div>
                <div class="param-item"><strong>Fastest Jaw Y Speed:</strong> <span id="jawYSpeedVal">N/A</span></div>
                <div class="param-item"><strong>Dose Rate (Estimated):</strong> <span id="doseRateVal">N/A</span></div>
                <div class="param-item"><strong>Local MIt:</strong> <span id="localMItVal">N/A</span></div>
                <div class="param-item"><strong>MIsport:</strong> <span id="miValSpan">N/A</span></div>
            </div>
        </div>

        <div class="visualization-section xy-time-plots-section" id="xyTimePlotsContainer" style="display:none;">
            <h2>Device Metrics vs. Time (Simulation Mode Only)</h2>
            <div class="xy-time-plot-grid">
                <div class="xy-time-plot-container">
                    <canvas id="gantryMetricsCanvas" class="xy-plot-canvas"></canvas>
                    <button class="reset-view-btn" data-plot-id="gantryMetrics">Reset View</button>
                </div>
                <div class="xy-time-plot-container">
                    <canvas id="mlcMetricsCanvas" class="xy-plot-canvas"></canvas>
                    <button class="reset-view-btn" data-plot-id="mlcMetrics">Reset View</button>
                </div>
                <div class="xy-time-plot-container">
                    <canvas id="collimatorMetricsCanvas" class="xy-plot-canvas"></canvas>
                    <button class="reset-view-btn" data-plot-id="collimatorMetrics">Reset View</button>
                </div>
                <div class="xy-time-plot-container">
                    <canvas id="doseRateTimeCanvas" class="xy-plot-canvas"></canvas>
                    <button class="reset-view-btn" data-plot-id="doseRateTime">Reset View</button>
                </div>
            </div>
        </div>
        <div class="author-info-header">
            <p><strong>Author:</strong> Taoran Li, PhD</p>
            <p><strong>Contact:</strong> taoran.li@varian.com</p>
            <p><strong>Version:</strong> 3.9.5 (Full MLC transition calculation and display)</p>
            <p><strong>Date:</strong> June 13, 2025</p>
        </div>

    </div>

    <!-- Bottom disclaimer -->
    <div class="disclaimer-footer">
        Bound by the terms of the <a href="gate/VarianLUSLA.html" target="_blank">VarianLUSLA</a>
    </div>
</body>

</html>
